# ThreatLens AI â€” Complete Frontend & Backend Plan

---

## Part 1: What The Final Website Looks Like

---

### Overall Design Philosophy
- **Dark theme** â€” industry standard for SOC dashboards, reduces eye strain during long monitoring shifts
- **Color language:** Green (safe) â†’ Yellow (medium) â†’ Orange (high) â†’ Red (critical)
- **Dense but organized** â€” SOC analysts need maximum information density without clutter
- **Real-time first** â€” everything updates live without page refresh
- **Evidence-forward** â€” visual proof is always one click away

---

### Page 1: Main Alert Feed (Homepage / `/`)

**What it looks like:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ›¡ï¸ ThreatLens AI          [LIVE â—]    02:07:34 AM  [Copilot]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚                                                   â”‚
â”‚  SIDEBAR     â”‚  ALERT FEED                                      â”‚
â”‚              â”‚                                                   â”‚
â”‚  ðŸ“Š Dashboardâ”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  ðŸš¨ Alerts   â”‚  â”‚ FILTERS: [All] [Critical] [High] [Medium]   â”‚ â”‚
â”‚  ðŸ“¹ Live Mon â”‚  â”‚          [Network] [Camera] [RF] [Logs]     â”‚ â”‚
â”‚  ðŸ¤– Copilot  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  ðŸ§¬ Threats  â”‚                                                   â”‚
â”‚  âš™ï¸ Settings â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚              â”‚  â”‚ âš ï¸ NEXT MOVE: Log deletion expected in 12minâ”‚ â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  SYSTEM      â”‚                                                   â”‚
â”‚  HEALTH      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚              â”‚  â”‚ ðŸ”´ CRITICAL  INC-2024-001          94/100   â”‚ â”‚
â”‚  Network âœ…  â”‚  â”‚ Insider Data Theft                           â”‚ â”‚
â”‚  Camera  âœ…  â”‚  â”‚ ðŸ“¹ Camera + ðŸ’» Logs + ðŸ“ Files + ðŸŒ Networkâ”‚ â”‚
â”‚  RF      âœ…  â”‚  â”‚ 02:07:01 AM  |  Server Room  |  4 sources  â”‚ â”‚
â”‚  Logs    âœ…  â”‚  â”‚ Intent: DATA EXFILTRATION  Conf: 94%        â”‚ â”‚
â”‚  Files   âœ…  â”‚  â”‚ [View Details]  [Isolate Host]  [Block IP]  â”‚ â”‚
â”‚  Sandbox âœ…  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚                                                   â”‚
â”‚  Incidents   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  Today: 3    â”‚  â”‚ ðŸŸ  HIGH      INC-2024-002          78/100   â”‚ â”‚
â”‚  Week:  12   â”‚  â”‚ Network Reconnaissance                       â”‚ â”‚
â”‚              â”‚  â”‚ ðŸŒ Network + ðŸ’» Logs                        â”‚ â”‚
â”‚              â”‚  â”‚ 01:45:22 AM  |  Internal  |  2 sources      â”‚ â”‚
â”‚              â”‚  â”‚ Intent: RECONNAISSANCE   Conf: 81%          â”‚ â”‚
â”‚              â”‚  â”‚ [View Details]  [Block IP]                  â”‚ â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚                                                   â”‚
â”‚              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚              â”‚  â”‚ ðŸŸ¡ MEDIUM    INC-2024-003          52/100   â”‚ â”‚
â”‚              â”‚  â”‚ Unusual Login Pattern                        â”‚ â”‚
â”‚              â”‚  â”‚ ðŸ’» Logs                                      â”‚ â”‚
â”‚              â”‚  â”‚ 01:12:05 AM  |  Lobby  |  1 source          â”‚ â”‚
â”‚              â”‚  â”‚ Intent: CREDENTIAL_ABUSE  Conf: 62%         â”‚ â”‚
â”‚              â”‚  â”‚ [View Details]                               â”‚ â”‚
â”‚              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**What displays:**
- Live incident cards sorted by risk score
- Each card shows: severity badge, incident ID, risk score, incident name, source icons, timestamp, zone, source count, intent classification, confidence, quick action buttons
- Predictive warning banner at top when next move predicted
- Sidebar system health indicators (green/red per data source)
- Real-time incident counter

---

### Page 2: Incident Detail (`/incident/:id`)

**Tab 1 â€” Overview & Timeline:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back    INC-2024-001    ðŸ”´ CRITICAL    Risk: 94/100          â”‚
â”‚  Intent: DATA EXFILTRATION  |  Confidence: 94%                  â”‚
â”‚  02:03 AM - 02:07 AM  |  Server Room  |  4 Sources Correlated   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Overview] [Attack Graph] [Evidence] [Sandbox] [XAI] [Chain]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  ATTACK TIMELINE                                                 â”‚
â”‚                                                                  â”‚
â”‚  02:03:12 â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”    â”‚
â”‚  ðŸ“¹ Camera  Unauthorized entry â€” Server Room                     â”‚
â”‚  Score: 92  |  No badge scan  |  After hours                    â”‚
â”‚             â†“                                                    â”‚
â”‚  02:04:05 â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”    â”‚
â”‚  ðŸ’» Logs    SSH login from new IP 192.168.1.157                 â”‚
â”‚  Score: 76  |  7 prior failures  |  Unknown IP                  â”‚
â”‚             â†“                                                    â”‚
â”‚  02:05:42 â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”    â”‚
â”‚  ðŸ“ Files   847 files encrypted by unknown_binary.exe           â”‚
â”‚  Score: 91  |  Mass encryption  |  Unknown process              â”‚
â”‚             â†“                                                    â”‚
â”‚  02:06:19 â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”    â”‚
â”‚  ðŸŒ Network 2.3GB transfer to 203.0.113.5                       â”‚
â”‚  Score: 87  |  53x baseline  |  Unknown destination             â”‚
â”‚             â†“                                                    â”‚
â”‚  âš ï¸ PREDICTED NEXT:  Log Deletion (T1070)  â€” within 12 min     â”‚
â”‚                                                                  â”‚
â”‚  RECOMMENDED ACTIONS                                             â”‚
â”‚  [ðŸ”’ Isolate Host] [ðŸš« Block IP] [ðŸ‘® Alert IR] [ðŸ“‹ Export]     â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tab 2 â€” Attack Graph:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CAUSAL ATTACK GRAPH                              [Export PNG]  â”‚
â”‚                                                                  â”‚
â”‚         [ðŸ“¹ CAM-001]                                            â”‚
â”‚         Unauthorized                                            â”‚
â”‚         Entry  92/100                                           â”‚
â”‚              â†“                                                  â”‚
â”‚         [ðŸ’» LOG-001]  â†â”€â”€ [ðŸ“¡ RF-001]                          â”‚
â”‚         SSH Login          Rogue Device                         â”‚
â”‚         76/100             85/100                               â”‚
â”‚              â†“                                                  â”‚
â”‚         [ðŸ“ FILE-001]                                           â”‚
â”‚         Mass Encrypt                                            â”‚
â”‚         91/100                                                  â”‚
â”‚              â†“                                                  â”‚
â”‚         [ðŸŒ NET-001]                                            â”‚
â”‚         Data Exfil                                              â”‚
â”‚         87/100                                                  â”‚
â”‚                                                                  â”‚
â”‚  â— Camera  â— Logs  â— Files  â— Network  â— RF                    â”‚
â”‚  Edge thickness = causal confidence                             â”‚
â”‚  [Zoom] [Pan] [Reset] [Export]                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tab 3 â€” Evidence Gallery:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EVIDENCE GALLERY                    All verified âœ… on Polygon  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ðŸ“¹ VIDEO EVIDENCE   â”‚  â”‚ ðŸ’» LOG EVIDENCE                 â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚  [Video Player] â”‚ â”‚  â”‚ â”‚ 02:03:58 Failed login from  â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  02:03:07 -     â”‚ â”‚  â”‚ â”‚          192.168.1.157      â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  02:03:17       â”‚ â”‚  â”‚ â”‚ 02:04:01 Failed login from  â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  Annotated with â”‚ â”‚  â”‚ â”‚          192.168.1.157 (Ã—5) â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  bounding boxes â”‚ â”‚  â”‚ â”‚ 02:04:05 Accepted publickey â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚          admin 192.168.1.157â”‚ â”‚  â”‚
â”‚  â”‚ âœ… Block #4821903   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ âœ… Block #4821904               â”‚  â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ðŸ“ FILE EVIDENCE    â”‚  â”‚ ðŸŒ NETWORK EVIDENCE             â”‚  â”‚
â”‚  â”‚ customer_data.sql   â”‚  â”‚ capture.pcap  [Download]        â”‚  â”‚
â”‚  â”‚ â†’ .encrypted        â”‚  â”‚ 1000 packets captured           â”‚  â”‚
â”‚  â”‚ SHA256: deadbeef... â”‚  â”‚ Flow: 192.168.1.157 â†’           â”‚  â”‚
â”‚  â”‚ Process: unknown... â”‚  â”‚       203.0.113.5:443           â”‚  â”‚
â”‚  â”‚ [Download]          â”‚  â”‚ Volume: 2.3GB in 34 seconds     â”‚  â”‚
â”‚  â”‚ âœ… Block #4821905   â”‚  â”‚ âœ… Block #4821906               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tab 4 â€” Sandbox Report:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SANDBOX DETONATION REPORT                                      â”‚
â”‚  File: unknown_binary.exe  |  Verdict: ðŸ”´ MALICIOUS  97/100   â”‚
â”‚                                                                  â”‚
â”‚  SCREENSHOT SEQUENCE (60 frames / 120 seconds)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ 0:00 â”‚â†’â”‚ 0:02 â”‚â†’â”‚ 0:04 â”‚â†’â”‚ 0:06 â”‚â†’â”‚ 0:08 â”‚â†’â”‚ 0:10 â”‚  ... â”‚
â”‚  â”‚[img] â”‚ â”‚[img] â”‚ â”‚[img] â”‚ â”‚[img] â”‚ â”‚[img] â”‚ â”‚[img] â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  [â—€] [â–¶] [Play] [Speed: 1x]                                    â”‚
â”‚                                                                  â”‚
â”‚  BEHAVIORAL SUMMARY                                             â”‚
â”‚  âœ— 847 files encrypted                                          â”‚
â”‚  âœ— Ransom note created: C:/ransom_note.txt                      â”‚
â”‚  âœ— Shadow copies deleted (vssadmin.exe)                         â”‚
â”‚  âœ— C2 callback: evil-c2.ru:443                                  â”‚
â”‚  âœ— Persistence: HKCU\Run\persist_malware                        â”‚
â”‚                                                                  â”‚
â”‚  EXTRACTED IOCs                                                  â”‚
â”‚  IPs:      203.0.113.5  198.51.100.3                            â”‚
â”‚  Domains:  evil-c2.ru                                           â”‚
â”‚  Hashes:   sha256:deadbeef...  sha256:cafebabe...               â”‚
â”‚  Registry: HKCU\Run\persist_malware                             â”‚
â”‚  [Export IOCs]  [Add to Blocklist]                              â”‚
â”‚                                                                  â”‚
â”‚  MITRE ATT&CK: T1486  T1490  T1071  T1547                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tab 5 â€” XAI Explanation:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EXPLAINABLE AI ANALYSIS                                        â”‚
â”‚                                                                  â”‚
â”‚  WHY RISK SCORE = 94?                                           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ CRITICAL: Coordinated insider data theft attack         â”‚   â”‚
â”‚  â”‚ detected with 94/100 risk score.                        â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ ðŸ“¹ Camera (92): Unauthorized person in Server Room at   â”‚   â”‚
â”‚  â”‚ 02:03 AM â€” 8 hours outside permitted window. No badge   â”‚   â”‚
â”‚  â”‚ scan. Person tracked as ID #7743.                       â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ ðŸ’» Logs (76): SSH login from new IP 192.168.1.157 after â”‚   â”‚
â”‚  â”‚ 7 failed attempts. Privilege escalated to root 53s      â”‚   â”‚
â”‚  â”‚ after login.                                            â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ ðŸ“ Files (91): 847 files encrypted in 60 seconds by    â”‚   â”‚
â”‚  â”‚ unknown_binary.exe. Extension: .sql â†’ .encrypted.      â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ ðŸŒ Network (87): 2.3GB to 203.0.113.5 â€” 53x baseline.  â”‚   â”‚
â”‚  â”‚ Unknown destination. Off-hours transfer.               â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ All 4 events within 4-minute window.                   â”‚   â”‚
â”‚  â”‚ MITRE: T1078 + T1041 + T1486                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  FEATURE IMPORTANCE (SHAP)                                      â”‚
â”‚  Network Model:                                                  â”‚
â”‚  bytes_sent        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ +18.5                  â”‚
â”‚  dst_ip_reputation â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ +12.3                          â”‚
â”‚  hour_of_day       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ +8.7                               â”‚
â”‚  dst_port          â–ˆâ–ˆ +2.1                                     â”‚
â”‚  duration          â–ˆ +1.2                                      â”‚
â”‚                                                                  â”‚
â”‚  PREDICTED NEXT MOVE                                             â”‚
â”‚  âš ï¸ Log Deletion (T1070) â€” within 15 min â€” 78% confidence      â”‚
â”‚  Recommendation: Isolate host + preserve logs immediately        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Tab 6 â€” Blockchain Chain of Custody:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BLOCKCHAIN EVIDENCE CHAIN                                      â”‚
â”‚  Network: Polygon Mumbai  |  All Evidence Verified âœ…           â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ðŸ“¹ clip.mp4                                   âœ… Verifiedâ”‚   â”‚
â”‚  â”‚ SHA256: abc123def456...                                  â”‚   â”‚
â”‚  â”‚ Block: #4821903  |  Tx: 0xdeadbeef...                   â”‚   â”‚
â”‚  â”‚ Anchored: 02:08:30 AM                                    â”‚   â”‚
â”‚  â”‚ [View on Polygonscan â†—]                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ðŸ’» auth_snippet.txt                           âœ… Verifiedâ”‚   â”‚
â”‚  â”‚ SHA256: xyz789uvw012...                                  â”‚   â”‚
â”‚  â”‚ Block: #4821904  |  Tx: 0xcafebabe...                   â”‚   â”‚
â”‚  â”‚ [View on Polygonscan â†—]                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  VERIFY EVIDENCE INTEGRITY                                      â”‚
â”‚  [Upload file to verify] â†’ System checks hash against chain     â”‚
â”‚  Result: âœ… Hash matches â€” Evidence untampered                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Page 3: Live Monitoring (`/live`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LIVE MONITORING DASHBOARD                    Updated: 02:07:45 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  NETWORK TRAFFIC (LIVE)      â”‚  LOGIN ATTEMPTS (LIVE)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    /\                  â”‚  â”‚  â”‚ Success â–ˆâ–ˆâ–ˆâ–ˆ 12            â”‚  â”‚
â”‚  â”‚   /  \    /\           â”‚  â”‚  â”‚ Failed  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 47    â”‚  â”‚
â”‚  â”‚  /    \  /  \    /\   â”‚  â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚ /      \/    \  /  \  â”‚  â”‚  â”‚ 02:00  02:02  02:04  02:06â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  Baseline: 45MB/hr           â”‚  Threshold: 5 failures/min       â”‚
â”‚  Current: 2.3GB/hr ðŸ”´        â”‚  Current: 23 failures/min ðŸ”´     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  CAMERA ZONE STATUS          â”‚  RF DEVICE MONITOR               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Server Room   ðŸ”´ ALERT â”‚  â”‚  â”‚ Known Devices: 4           â”‚  â”‚
â”‚  â”‚ [Person detected]      â”‚  â”‚  â”‚ Unknown:       1 ðŸ”´        â”‚  â”‚
â”‚  â”‚ Lobby         ðŸŸ¢ CLEAR â”‚  â”‚  â”‚                            â”‚  â”‚
â”‚  â”‚ Data Center   ðŸŸ¢ CLEAR â”‚  â”‚  â”‚ AA:BB:CC:DD:EE:FF          â”‚  â”‚
â”‚  â”‚ Office        ðŸŸ¢ CLEAR â”‚  â”‚  â”‚ WiFi  -45dBm  Zone: SrvRm  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FILE MODIFICATION FEED      â”‚  ANOMALY SCORE METERS            â”‚
â”‚  02:05:42 /var/db/*.sql ðŸ”´   â”‚  Network  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 87/100     â”‚
â”‚  02:05:43 /var/db/*.sql ðŸ”´   â”‚  Camera   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 92/100     â”‚
â”‚  02:05:44 /var/db/*.sql ðŸ”´   â”‚  RF       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 85/100     â”‚
â”‚  02:05:45 /var/db/*.sql ðŸ”´   â”‚  Logs     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 76/100     â”‚
â”‚  [847 files in 60s] ðŸ”´       â”‚  Files    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 91/100     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Page 4: SOC Copilot (`/copilot`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ¤– SOC COPILOT  |  Powered by Mistral-7B (Local)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  [ANALYST]  What happened in the server room last night?        â”‚
â”‚                                                                  â”‚
â”‚  [THREATLENS AI]                                                 â”‚
â”‚  Between 02:03 AM and 02:07 AM, ThreatLens detected a          â”‚
â”‚  coordinated attack in the server room (INC-2024-001,           â”‚
â”‚  risk 94/100). An unauthorized person entered at 02:03 AM       â”‚
â”‚  with no badge scan. 52 seconds later, SSH login from a         â”‚
â”‚  new IP. By 02:05 AM, 847 database files were being             â”‚
â”‚  encrypted. At 02:06 AM, 2.3GB was transferred externally.      â”‚
â”‚  Evidence is blockchain-verified.                               â”‚
â”‚  â†’ View INC-2024-001                                            â”‚
â”‚                                                                  â”‚
â”‚  [ANALYST]  What IPs should I block right now?                  â”‚
â”‚                                                                  â”‚
â”‚  [THREATLENS AI]                                                 â”‚
â”‚  Based on active incidents, block these immediately:            â”‚
â”‚  1. 203.0.113.5 â€” C2 server (INC-2024-001, sandbox confirmed)  â”‚
â”‚  2. 198.51.100.3 â€” Secondary C2 (sandbox IOC)                  â”‚
â”‚  3. 192.168.1.157 â€” Internal compromised host                   â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Type your question...]                          [Send â†µ]      â”‚
â”‚  Suggested: "Show all critical incidents today"                 â”‚
â”‚             "What files were modified in the last hour?"        â”‚
â”‚             "Which hosts should be isolated?"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Page 5: Threat Intelligence (`/threats`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  THREAT INTELLIGENCE                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MITRE ATT&CK HEATMAP    â”‚  ACTIVE IOC FEED                    â”‚
â”‚                          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  Recon    â–ˆâ–ˆâ–ˆâ–ˆ 2         â”‚  â”‚ ðŸ”´ 203.0.113.5  C2 Server      â”‚  â”‚
â”‚  Init Acc â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 5     â”‚  â”‚    Sandbox confirmed malicious  â”‚  â”‚
â”‚  Exec     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 3       â”‚  â”‚    [Add to Firewall]            â”‚  â”‚
â”‚  Persist  â–ˆâ–ˆâ–ˆâ–ˆ 2         â”‚  â”‚                                â”‚  â”‚
â”‚  Priv Esc â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 3       â”‚  â”‚ ðŸ”´ evil-c2.ru  C2 Domain       â”‚  â”‚
â”‚  Lat Move â–ˆâ–ˆâ–ˆâ–ˆ 2         â”‚  â”‚    DNS tunneling suspected      â”‚  â”‚
â”‚  Exfil    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 4     â”‚  â”‚    [Block DNS]                  â”‚  â”‚
â”‚  Impact   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 3       â”‚  â”‚                                â”‚  â”‚
â”‚                          â”‚  â”‚ ðŸŸ  sha256:deadbeef  Malware     â”‚  â”‚
â”‚  IP THREAT MAP           â”‚  â”‚    Ransomware family: LockBit   â”‚  â”‚
â”‚  [World map with         â”‚  â”‚    [Add to AV signatures]       â”‚  â”‚
â”‚   threat origin dots]    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                          â”‚                                      â”‚
â”‚  Most threats from:      â”‚  ATTACK INTENT BREAKDOWN            â”‚
â”‚  RU: 3  CN: 2  US: 1    â”‚  Ransomware      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 40%       â”‚
â”‚                          â”‚  Data Exfil      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 30%         â”‚
â”‚                          â”‚  Reconnaissance  â–ˆâ–ˆâ–ˆâ–ˆ 20%           â”‚
â”‚                          â”‚  Insider Threat  â–ˆâ–ˆ 10%             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Part 2: Backend Implementation Plan

---

### Backend Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASTAPI APPLICATION                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  REST Endpoints  â”‚  WebSocket Endpoints  â”‚  Background   â”‚
â”‚  (CRUD, queries) â”‚  (real-time streams)  â”‚  Workers      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Kafka Consumers â”‚  Redis Cache          â”‚  MinIO Client â”‚
â”‚  (event pipeline)â”‚  (fast lookups)       â”‚  (evidence)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL (incidents)  â”‚  Elasticsearch (logs/events)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Project Structure

```
threatlens-backend/
â”œâ”€â”€ main.py                    # FastAPI app entry point
â”œâ”€â”€ config.py                  # All env vars and settings
â”œâ”€â”€ docker-compose.yml         # All services
â”‚
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ incidents.py       # Incident CRUD endpoints
â”‚   â”‚   â”œâ”€â”€ evidence.py        # Evidence retrieval
â”‚   â”‚   â”œâ”€â”€ sandbox.py         # Sandbox report endpoints
â”‚   â”‚   â”œâ”€â”€ blockchain.py      # Blockchain verification
â”‚   â”‚   â”œâ”€â”€ iocs.py            # IOC management
â”‚   â”‚   â”œâ”€â”€ copilot.py         # LLM copilot endpoint
â”‚   â”‚   â””â”€â”€ live.py            # Live monitoring data
â”‚   â”‚
â”‚   â””â”€â”€ websockets/
â”‚       â”œâ”€â”€ alerts.py          # Real-time alert stream
â”‚       â”œâ”€â”€ live_network.py    # Live network chart data
â”‚       â”œâ”€â”€ live_camera.py     # Live camera alert feed
â”‚       â””â”€â”€ manager.py         # WebSocket connection manager
â”‚
â”œâ”€â”€ consumers/
â”‚   â”œâ”€â”€ base_consumer.py       # Base Kafka consumer class
â”‚   â”œâ”€â”€ incident_consumer.py   # Consumes correlated-incidents
â”‚   â”œâ”€â”€ evidence_consumer.py   # Consumes evidence-manifest
â”‚   â”œâ”€â”€ sandbox_consumer.py    # Consumes sandbox-results
â”‚   â””â”€â”€ live_consumer.py       # Consumes all anomaly topics
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ blockchain_service.py  # Polygon anchoring logic
â”‚   â”œâ”€â”€ evidence_service.py    # MinIO file operations
â”‚   â”œâ”€â”€ elasticsearch_service.py
â”‚   â”œâ”€â”€ redis_service.py
â”‚   â””â”€â”€ copilot_service.py     # Ollama LLM integration
â”‚
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ incident.py            # Pydantic models
â”‚   â”œâ”€â”€ evidence.py
â”‚   â”œâ”€â”€ sandbox.py
â”‚   â””â”€â”€ alert.py
â”‚
â””â”€â”€ database/
    â”œâ”€â”€ postgres.py            # SQLAlchemy setup
    â””â”€â”€ schemas.py             # DB table definitions
```

---

### Step 1: Environment Setup (Hour 0-2)

**docker-compose.yml â€” all services P1 needs:**
```yaml
version: '3.8'
services:
  
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: threatlens
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: threatlens123
    ports: ["5432:5432"]
    volumes: ["postgres_data:/var/lib/postgresql/data"]

  redis:
    image: redis:7-alpine
    ports: ["6379:6379"]

  elasticsearch:
    image: elasticsearch:8.11.0
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
    ports: ["9200:9200"]
    
  minio:
    image: minio/minio
    command: server /data --console-address ":9001"
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin123
    ports: ["9000:9000", "9001:9001"]
    volumes: ["minio_data:/data"]

  kafka:
    image: confluentinc/cp-kafka:7.5.0
    environment:
      KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
      KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://localhost:9092
    ports: ["9092:9092"]
    depends_on: [zookeeper]

  zookeeper:
    image: confluentinc/cp-zookeeper:7.5.0
    environment:
      ZOOKEEPER_CLIENT_PORT: 2181
    ports: ["2181:2181"]

  neo4j:
    image: neo4j:5.14
    environment:
      NEO4J_AUTH: neo4j/threatlens123
    ports: ["7474:7474", "7687:7687"]

  ollama:
    image: ollama/ollama
    ports: ["11434:11434"]
    volumes: ["ollama_data:/root/.ollama"]
    # After startup: docker exec ollama ollama pull mistral:7b
```

---

### Step 2: FastAPI Application Setup (Hour 2-4)

**main.py:**
```python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from contextlib import asynccontextmanager
import asyncio

from api.routes import incidents, evidence, sandbox, blockchain, iocs, copilot, live
from api.websockets import alerts, live_network, live_camera
from consumers.incident_consumer import IncidentConsumer
from consumers.live_consumer import LiveConsumer
from database.postgres import create_tables

@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup: initialize DB tables, start Kafka consumers
    await create_tables()
    
    # Start Kafka consumers as background tasks
    asyncio.create_task(IncidentConsumer().run())
    asyncio.create_task(LiveConsumer().run())
    
    yield
    # Shutdown cleanup here

app = FastAPI(
    title="ThreatLens AI",
    description="XAI-Enabled Cyber Defense Monitor",
    version="1.0.0",
    lifespan=lifespan
)

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# REST routes
app.include_router(incidents.router, prefix="/api/incidents", tags=["incidents"])
app.include_router(evidence.router, prefix="/api/evidence", tags=["evidence"])
app.include_router(sandbox.router, prefix="/api/sandbox", tags=["sandbox"])
app.include_router(blockchain.router, prefix="/api/blockchain", tags=["blockchain"])
app.include_router(iocs.router, prefix="/api/iocs", tags=["iocs"])
app.include_router(copilot.router, prefix="/api/copilot", tags=["copilot"])
app.include_router(live.router, prefix="/api/live", tags=["live"])

# WebSocket routes
app.include_router(alerts.router, prefix="/ws")
app.include_router(live_network.router, prefix="/ws")
app.include_router(live_camera.router, prefix="/ws")
```

---

### Step 3: Database Schema (Hour 2-4)

**database/schemas.py:**
```python
from sqlalchemy import Column, String, Integer, Float, JSON, DateTime, Boolean
from sqlalchemy.ext.declarative import declarative_base
from datetime import datetime

Base = declarative_base()

class Incident(Base):
    __tablename__ = "incidents"
    
    incident_id = Column(String, primary_key=True)
    timestamp = Column(DateTime, default=datetime.utcnow)
    risk_score = Column(Integer)
    severity = Column(String)  # LOW/MEDIUM/HIGH/CRITICAL
    rule_name = Column(String)
    sources_involved = Column(JSON)       # ["camera", "logs", "network"]
    correlated_events = Column(JSON)      # full event list
    intent_primary = Column(String)
    intent_confidence = Column(Float)
    mitre_ttps = Column(JSON)             # ["T1078", "T1041"]
    current_attack_stage = Column(String)
    predicted_next_move = Column(JSON)
    nlg_explanation = Column(JSON)        # full NLG output
    sandbox_triggered = Column(Boolean, default=False)
    evidence_captured = Column(Boolean, default=False)
    blockchain_anchored = Column(Boolean, default=False)
    status = Column(String, default="open")  # open/investigating/resolved
    zone = Column(String)
    neo4j_node_ids = Column(JSON)

class Evidence(Base):
    __tablename__ = "evidence"
    
    evidence_id = Column(String, primary_key=True)
    incident_id = Column(String)
    capture_timestamp = Column(DateTime)
    evidence_type = Column(String)    # video/logs/pcap/file/screenshot
    file_path = Column(String)        # MinIO path
    sha256_hash = Column(String)
    blockchain_tx_hash = Column(String)
    blockchain_block_number = Column(Integer)
    verified = Column(Boolean, default=False)
    metadata = Column(JSON)

class SandboxResult(Base):
    __tablename__ = "sandbox_results"
    
    result_id = Column(String, primary_key=True)
    incident_id = Column(String)
    file_hash = Column(String)
    verdict = Column(String)          # MALICIOUS/SUSPICIOUS/BENIGN
    confidence_score = Column(Integer)
    behavioral_summary = Column(JSON)
    extracted_iocs = Column(JSON)
    screenshot_paths = Column(JSON)   # list of MinIO paths
    mitre_behaviors = Column(JSON)
    detonation_timestamp = Column(DateTime)

class IOC(Base):
    __tablename__ = "iocs"
    
    ioc_id = Column(String, primary_key=True)
    incident_id = Column(String)
    ioc_type = Column(String)         # ip/domain/hash/registry
    value = Column(String)
    confidence = Column(Float)
    source = Column(String)           # sandbox/manual/feed
    first_seen = Column(DateTime)
    times_seen = Column(Integer, default=1)
    blocked = Column(Boolean, default=False)
```

---

### Step 4: Kafka Consumer â€” Core Pipeline (Hour 4-8)

**consumers/incident_consumer.py:**
```python
from confluent_kafka import Consumer
import json
import asyncio
from services.blockchain_service import BlockchainService
from database.postgres import get_db
from models.incident import IncidentCreate
from api.websockets.manager import websocket_manager

class IncidentConsumer:
    def __init__(self):
        self.consumer = Consumer({
            "bootstrap.servers": "localhost:9092",
            "group.id": "incident-processor",
            "auto.offset.reset": "latest"
        })
        self.consumer.subscribe([
            "correlated-incidents",
            "evidence-manifest",
            "sandbox-results",
            "nlg-explanations",
            "blockchain-receipts"
        ])
        self.blockchain = BlockchainService()
    
    async def run(self):
        while True:
            msg = self.consumer.poll(timeout=0.1)
            if msg is None:
                await asyncio.sleep(0.01)
                continue
            
            data = json.loads(msg.value())
            topic = msg.topic()
            
            if topic == "correlated-incidents":
                await self.handle_incident(data)
            elif topic == "evidence-manifest":
                await self.handle_evidence(data)
            elif topic == "sandbox-results":
                await self.handle_sandbox(data)
            elif topic == "nlg-explanations":
                await self.handle_explanation(data)
    
    async def handle_incident(self, incident_data):
        # 1. Save to PostgreSQL
        async with get_db() as db:
            incident = Incident(**incident_data)
            db.add(incident)
            await db.commit()
        
        # 2. Push to all connected WebSocket clients immediately
        await websocket_manager.broadcast_to_alerts({
            "type": "new_incident",
            "data": incident_data
        })
        
        print(f"New incident: {incident_data['incident_id']} Risk: {incident_data['risk_score']}")
    
    async def handle_evidence(self, evidence_data):
        # 1. Save evidence records to PostgreSQL
        # 2. Trigger blockchain anchoring
        await self.blockchain.anchor_evidence(evidence_data)
        
        # 3. Update incident record
        async with get_db() as db:
            await db.execute(
                "UPDATE incidents SET evidence_captured=true WHERE incident_id=:id",
                {"id": evidence_data["incident_id"]}
            )
    
    async def handle_sandbox(self, sandbox_data):
        # 1. Save sandbox result to PostgreSQL
        # 2. Extract and save IOCs
        # 3. Notify dashboard
        await websocket_manager.broadcast_to_alerts({
            "type": "sandbox_complete",
            "data": sandbox_data
        })
```

---

### Step 5: WebSocket Manager (Hour 6-8)

**api/websockets/manager.py:**
```python
from fastapi import WebSocket
from typing import Dict, List
import json

class WebSocketManager:
    def __init__(self):
        # Different channels for different dashboard sections
        self.alert_connections: List[WebSocket] = []
        self.live_connections: Dict[str, List[WebSocket]] = {
            "network": [],
            "camera": [],
            "rf": [],
            "logs": [],
            "files": []
        }
    
    async def connect_alerts(self, websocket: WebSocket):
        await websocket.accept()
        self.alert_connections.append(websocket)
    
    async def connect_live(self, websocket: WebSocket, source: str):
        await websocket.accept()
        self.live_connections[source].append(websocket)
    
    async def disconnect(self, websocket: WebSocket):
        if websocket in self.alert_connections:
            self.alert_connections.remove(websocket)
        for source_list in self.live_connections.values():
            if websocket in source_list:
                source_list.remove(websocket)
    
    async def broadcast_to_alerts(self, message: dict):
        dead_connections = []
        for websocket in self.alert_connections:
            try:
                await websocket.send_json(message)
            except Exception:
                dead_connections.append(websocket)
        for ws in dead_connections:
            self.alert_connections.remove(ws)
    
    async def broadcast_to_live(self, source: str, message: dict):
        for websocket in self.live_connections.get(source, []):
            try:
                await websocket.send_json(message)
            except Exception:
                pass

websocket_manager = WebSocketManager()

# WebSocket endpoint
from fastapi import APIRouter
router = APIRouter()

@router.websocket("/alerts")
async def alerts_websocket(websocket: WebSocket):
    await websocket_manager.connect_alerts(websocket)
    try:
        while True:
            # Keep connection alive
            await websocket.receive_text()
    except Exception:
        await websocket_manager.disconnect(websocket)
```

---

### Step 6: REST API Endpoints (Hour 8-16)

**api/routes/incidents.py:**
```python
from fastapi import APIRouter, Query
from typing import Optional
from database.postgres import get_db

router = APIRouter()

# GET /api/incidents â€” paginated incident list
@router.get("/")
async def get_incidents(
    page: int = 1,
    limit: int = 20,
    severity: Optional[str] = None,    # CRITICAL/HIGH/MEDIUM/LOW
    source: Optional[str] = None,       # camera/network/logs/rf/file
    min_risk: Optional[int] = None,
    status: Optional[str] = "open"
):
    # Build filtered query against PostgreSQL
    # Return paginated list of incidents
    pass

# GET /api/incidents/:id â€” full incident detail
@router.get("/{incident_id}")
async def get_incident(incident_id: str):
    # Return complete incident with all sub-data
    pass

# GET /api/incidents/:id/timeline â€” correlated event timeline
@router.get("/{incident_id}/timeline")
async def get_timeline(incident_id: str):
    # Return ordered list of correlated events with timestamps
    pass

# GET /api/incidents/:id/graph â€” attack graph data for D3.js
@router.get("/{incident_id}/graph")
async def get_attack_graph(incident_id: str):
    # Query Neo4j for nodes and edges
    # Return: {nodes: [...], edges: [...]} for D3.js
    pass

# PATCH /api/incidents/:id/status â€” update incident status
@router.patch("/{incident_id}/status")
async def update_status(incident_id: str, status: str):
    pass
```

**api/routes/evidence.py:**
```python
@router.get("/{incident_id}")
async def get_evidence(incident_id: str):
    # Return evidence manifest with all file URLs
    # Generate presigned MinIO URLs for direct file access
    pass

@router.get("/{incident_id}/verify")
async def verify_evidence(incident_id: str):
    # Recompute hashes, check against blockchain
    # Return verification status per file
    pass

@router.post("/verify-file")
async def verify_single_file(file: UploadFile):
    # Analyst uploads a file
    # Compute hash, check against blockchain
    # Return: verified/tampered
    pass
```

**api/routes/copilot.py:**
```python
@router.post("/query")
async def copilot_query(question: str):
    # 1. Parse question to determine what data to retrieve
    # 2. Query Elasticsearch for relevant events
    # 3. Query PostgreSQL for relevant incidents
    # 4. Build context string
    # 5. Send to Ollama Mistral-7B
    # 6. Return response with supporting evidence links
    pass
```

---

### Step 7: Blockchain Service (Hour 16-20)

**services/blockchain_service.py:**
```python
from web3 import Web3
import hashlib
import json

class BlockchainService:
    def __init__(self):
        self.w3 = Web3(Web3.HTTPProvider("https://rpc-mumbai.polygon.technology"))
        self.contract = self.w3.eth.contract(
            address="0x...",   # deployed contract address
            abi=self.load_abi()
        )
        self.wallet = self.w3.eth.account.from_key("private_key_from_env")
    
    def compute_hash(self, file_path: str) -> str:
        sha256 = hashlib.sha256()
        with open(file_path, "rb") as f:
            for chunk in iter(lambda: f.read(8192), b""):
                sha256.update(chunk)
        return sha256.hexdigest()
    
    async def anchor_evidence(self, evidence_manifest: dict) -> dict:
        receipts = []
        
        for evidence_type, evidence_data in evidence_manifest["evidence"].items():
            file_path = evidence_data.get("video_clip") or \
                        evidence_data.get("log_snippet_path") or \
                        evidence_data.get("pcap_path")
            
            if not file_path:
                continue
            
            file_hash = self.compute_hash(file_path)
            hash_bytes = bytes.fromhex(file_hash)
            
            # Build transaction
            tx = self.contract.functions.registerEvidence(
                hash_bytes
            ).build_transaction({
                "from": self.wallet.address,
                "nonce": self.w3.eth.get_transaction_count(self.wallet.address),
                "gas": 100000,
                "gasPrice": self.w3.to_wei("30", "gwei")
            })
            
            # Sign and send
            signed = self.wallet.sign_transaction(tx)
            tx_hash = self.w3.eth.send_raw_transaction(signed.rawTransaction)
            receipt = self.w3.eth.wait_for_transaction_receipt(tx_hash)
            
            receipts.append({
                "file": file_path,
                "sha256": file_hash,
                "tx_hash": receipt["transactionHash"].hex(),
                "block_number": receipt["blockNumber"],
                "polygonscan_url": f"https://mumbai.polygonscan.com/tx/{tx_hash.hex()}"
            })
        
        return receipts
    
    def verify_evidence(self, file_path: str, expected_hash: str) -> bool:
        current_hash = self.compute_hash(file_path)
        on_chain = self.contract.functions.verifyEvidence(
            bytes.fromhex(expected_hash)
        ).call()
        return current_hash == expected_hash and on_chain[0]
```

---

### Step 8: MinIO Evidence Service (Hour 14-16)

**services/evidence_service.py:**
```python
from minio import Minio
from minio.error import S3Error
import os

class EvidenceService:
    def __init__(self):
        self.client = Minio(
            "localhost:9000",
            access_key="minioadmin",
            secret_key="minioadmin123",
            secure=False
        )
        self.bucket = "threatlens-evidence"
        self._ensure_bucket()
    
    def _ensure_bucket(self):
        if not self.client.bucket_exists(self.bucket):
            self.client.make_bucket(self.bucket)
    
    def upload_evidence(self, incident_id: str, 
                       file_path: str, evidence_type: str) -> str:
        object_name = f"{incident_id}/{evidence_type}/{os.path.basename(file_path)}"
        self.client.fput_object(self.bucket, object_name, file_path)
        return object_name
    
    def get_presigned_url(self, object_name: str, 
                          expires_hours: int = 1) -> str:
        from datetime import timedelta
        return self.client.presigned_get_object(
            self.bucket, object_name,
            expires=timedelta(hours=expires_hours)
        )
    
    def download_evidence(self, object_name: str, local_path: str):
        self.client.fget_object(self.bucket, object_name, local_path)
```

---

### Step 9: Copilot Service (Hour 20-24)

**services/copilot_service.py:**
```python
import httpx
import json
from services.elasticsearch_service import ElasticsearchService

class CopilotService:
    def __init__(self):
        self.ollama_url = "http://localhost:11434/api/chat"
        self.es = ElasticsearchService()
    
    async def query(self, question: str) -> dict:
        # Step 1: Retrieve relevant context from Elasticsearch
        context_events = await self.es.search_relevant_events(question)
        
        # Step 2: Build structured prompt
        prompt = self._build_prompt(question, context_events)
        
        # Step 3: Send to Mistral-7B via Ollama
        async with httpx.AsyncClient(timeout=30.0) as client:
            response = await client.post(
                self.ollama_url,
                json={
                    "model": "mistral:7b",
                    "messages": [{"role": "user", "content": prompt}],
                    "options": {"temperature": 0.1},
                    "stream": False
                }
            )
        
        result = response.json()
        llm_response = result["message"]["content"]
        
        return {
            "question": question,
            "response": llm_response,
            "supporting_events": [e["event_id"] for e in context_events[:5]],
            "context_event_count": len(context_events)
        }
    
    def _build_prompt(self, question: str, context: list) -> str:
        context_str = json.dumps(context[:10], indent=2)
        return f"""You are a cybersecurity SOC analyst assistant for ThreatLens AI.
Answer using ONLY the security event data provided below.
Do not invent information. Be concise and reference specific timestamps and scores.

SECURITY EVENT DATA:
{context_str}

ANALYST QUESTION: {question}

Provide a clear answer suitable for a SOC analyst. Reference incident IDs when relevant."""
```

---

## Part 3: Frontend Implementation Plan

---

### Project Structure

```
threatlens-frontend/
â”œâ”€â”€ public/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.jsx                    # Router setup
â”‚   â”œâ”€â”€ main.jsx                   # Entry point
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.jsx        # Navigation sidebar
â”‚   â”‚   â”‚   â”œâ”€â”€ TopBar.jsx         # Header with live indicator
â”‚   â”‚   â”‚   â””â”€â”€ Layout.jsx         # Page wrapper
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ alerts/
â”‚   â”‚   â”‚   â”œâ”€â”€ AlertFeed.jsx      # Main incident list
â”‚   â”‚   â”‚   â”œâ”€â”€ AlertCard.jsx      # Single incident card
â”‚   â”‚   â”‚   â”œâ”€â”€ AlertFilters.jsx   # Filter bar
â”‚   â”‚   â”‚   â””â”€â”€ PredictionBanner.jsx # Next-move warning
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ incident/
â”‚   â”‚   â”‚   â”œâ”€â”€ IncidentHeader.jsx # Risk score + severity
â”‚   â”‚   â”‚   â”œâ”€â”€ TimelineView.jsx   # Correlated event timeline
â”‚   â”‚   â”‚   â”œâ”€â”€ AttackGraph.jsx    # D3.js causal graph
â”‚   â”‚   â”‚   â”œâ”€â”€ EvidenceGallery.jsx# Video/logs/pcap viewer
â”‚   â”‚   â”‚   â”œâ”€â”€ SandboxReport.jsx  # Screenshot carousel + IOCs
â”‚   â”‚   â”‚   â”œâ”€â”€ XAIPanel.jsx       # SHAP + NLG explanation
â”‚   â”‚   â”‚   â””â”€â”€ BlockchainPanel.jsx# Evidence verification
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ live/
â”‚   â”‚   â”‚   â”œâ”€â”€ NetworkChart.jsx   # Real-time traffic chart
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginHeatmap.jsx   # Auth attempt visualization
â”‚   â”‚   â”‚   â”œâ”€â”€ CameraStatus.jsx   # Zone status indicators
â”‚   â”‚   â”‚   â”œâ”€â”€ RFMonitor.jsx      # RF device list
â”‚   â”‚   â”‚   â”œâ”€â”€ FileEventFeed.jsx  # File modification feed
â”‚   â”‚   â”‚   â””â”€â”€ AnomalyMeters.jsx  # Score gauges
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ copilot/
â”‚   â”‚   â”‚   â”œâ”€â”€ CopilotChat.jsx    # Chat interface
â”‚   â”‚   â”‚   â””â”€â”€ MessageBubble.jsx  # Chat message component
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ threats/
â”‚   â”‚       â”œâ”€â”€ MitreHeatmap.jsx   # ATT&CK heatmap
â”‚   â”‚       â”œâ”€â”€ IOCFeed.jsx        # IOC list
â”‚   â”‚       â”œâ”€â”€ ThreatMap.jsx      # Geographic IP map
â”‚   â”‚       â””â”€â”€ IntentChart.jsx    # Attack intent breakdown
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ AlertsPage.jsx
â”‚   â”‚   â”œâ”€â”€ IncidentPage.jsx
â”‚   â”‚   â”œâ”€â”€ LivePage.jsx
â”‚   â”‚   â”œâ”€â”€ CopilotPage.jsx
â”‚   â”‚   â””â”€â”€ ThreatsPage.jsx
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useWebSocket.js        # WebSocket connection hook
â”‚   â”‚   â”œâ”€â”€ useAlerts.js           # Alert state management
â”‚   â”‚   â””â”€â”€ useLiveData.js         # Live chart data hook
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ api.js                 # Axios instance + all API calls
â”‚   â”‚   â””â”€â”€ websocket.js           # WebSocket client
â”‚   â”‚
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ riskColors.js          # Risk score â†’ color mapping
â”‚       â”œâ”€â”€ formatters.js          # Date, size formatters
â”‚       â””â”€â”€ mitreMap.js            # TTP code â†’ name mapping
```

---

### Step 1: Setup and Routing (Hour 0-2)

**App.jsx:**
```jsx
import { BrowserRouter, Routes, Route } from 'react-router-dom'
import Layout from './components/layout/Layout'
import AlertsPage from './pages/AlertsPage'
import IncidentPage from './pages/IncidentPage'
import LivePage from './pages/LivePage'
import CopilotPage from './pages/CopilotPage'
import ThreatsPage from './pages/ThreatsPage'

export default function App() {
  return (
    <BrowserRouter>
      <Layout>
        <Routes>
          <Route path="/" element={<AlertsPage />} />
          <Route path="/incident/:id" element={<IncidentPage />} />
          <Route path="/live" element={<LivePage />} />
          <Route path="/copilot" element={<CopilotPage />} />
          <Route path="/threats" element={<ThreatsPage />} />
        </Routes>
      </Layout>
    </BrowserRouter>
  )
}
```

**Global dark theme (index.css):**
```css
:root {
  --bg-primary: #0a0e1a;
  --bg-secondary: #111827;
  --bg-card: #1a2233;
  --border: #1e2d45;
  --text-primary: #e2e8f0;
  --text-secondary: #94a3b8;
  --critical: #ef4444;
  --high: #f97316;
  --medium: #eab308;
  --low: #22c55e;
  --accent: #3b82f6;
}

body {
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: 'Inter', monospace;
}
```

---

### Step 2: WebSocket Hook (Hour 2-4)

**hooks/useWebSocket.js:**
```javascript
import { useEffect, useRef, useState, useCallback } from 'react'

export function useWebSocket(url) {
  const ws = useRef(null)
  const [messages, setMessages] = useState([])
  const [connected, setConnected] = useState(false)

  useEffect(() => {
    ws.current = new WebSocket(url)
    
    ws.current.onopen = () => setConnected(true)
    ws.current.onclose = () => {
      setConnected(false)
      // Auto-reconnect after 3 seconds
      setTimeout(() => ws.current = new WebSocket(url), 3000)
    }
    ws.current.onmessage = (event) => {
      const data = JSON.parse(event.data)
      setMessages(prev => [data, ...prev].slice(0, 100))
    }
    
    return () => ws.current?.close()
  }, [url])

  return { messages, connected }
}
```

---

### Step 3: Alert Feed (Hour 4-10)

**components/alerts/AlertCard.jsx:**
```jsx
import { useNavigate } from 'react-router-dom'

const SEVERITY_CONFIG = {
  CRITICAL: { color: '#ef4444', bg: '#450a0a', icon: 'ðŸ”´', border: '#7f1d1d' },
  HIGH:     { color: '#f97316', bg: '#431407', icon: 'ðŸŸ ', border: '#7c2d12' },
  MEDIUM:   { color: '#eab308', bg: '#422006', icon: 'ðŸŸ¡', border: '#713f12' },
  LOW:      { color: '#22c55e', bg: '#052e16', icon: 'ðŸŸ¢', border: '#14532d' }
}

const SOURCE_ICONS = {
  camera: 'ðŸ“¹', logs: 'ðŸ’»', network: 'ðŸŒ', rf: 'ðŸ“¡', file: 'ðŸ“'
}

export default function AlertCard({ incident }) {
  const navigate = useNavigate()
  const config = SEVERITY_CONFIG[incident.severity]

  return (
    <div style={{
      background: config.bg,
      border: `1px solid ${config.border}`,
      borderRadius: '8px',
      padding: '16px',
      marginBottom: '12px',
      cursor: 'pointer'
    }}
    onClick={() => navigate(`/incident/${incident.incident_id}`)}
    >
      {/* Header row */}
      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
          <span style={{ fontSize: '20px' }}>{config.icon}</span>
          <div>
            <span style={{ color: config.color, fontWeight: 'bold', fontSize: '14px' }}>
              {incident.severity}
            </span>
            <span style={{ color: '#64748b', fontSize: '12px', marginLeft: '12px' }}>
              {incident.incident_id}
            </span>
          </div>
        </div>
        <div style={{
          background: config.color,
          color: 'white',
          borderRadius: '20px',
          padding: '4px 12px',
          fontWeight: 'bold',
          fontSize: '18px'
        }}>
          {incident.risk_score}/100
        </div>
      </div>

      {/* Incident name */}
      <div style={{ fontSize: '16px', fontWeight: '600', margin: '8px 0', color: '#e2e8f0' }}>
        {incident.rule_name}
      </div>

      {/* Source icons */}
      <div style={{ display: 'flex', gap: '8px', margin: '8px 0' }}>
        {incident.sources_involved.map(source => (
          <span key={source} style={{
            background: '#1e2d45',
            padding: '4px 10px',
            borderRadius: '4px',
            fontSize: '12px'
          }}>
            {SOURCE_ICONS[source]} {source}
          </span>
        ))}
      </div>

      {/* Meta info */}
      <div style={{ display: 'flex', gap: '16px', fontSize: '12px', color: '#64748b' }}>
        <span>ðŸ• {formatTime(incident.timestamp)}</span>
        <span>ðŸ“ {incident.zone}</span>
        <span>ðŸ”— {incident.sources_involved.length} sources</span>
      </div>

      {/* Intent badge */}
      <div style={{ marginTop: '8px', display: 'flex', alignItems: 'center', gap: '8px' }}>
        <span style={{ fontSize: '12px', color: '#94a3b8' }}>Intent:</span>
        <span style={{
          background: '#1e3a5f',
          color: '#60a5fa',
          padding: '2px 8px',
          borderRadius: '4px',
          fontSize: '12px',
          fontWeight: '600'
        }}>
          {incident.intent_primary.replace('_', ' ')}
        </span>
        <span style={{ fontSize: '12px', color: '#64748b' }}>
          {Math.round(incident.intent_confidence * 100)}% confidence
        </span>
      </div>

      {/* Action buttons */}
      <div style={{ display: 'flex', gap: '8px', marginTop: '12px' }}
           onClick={e => e.stopPropagation()}>
        <button onClick={() => navigate(`/incident/${incident.incident_id}`)}>
          View Details
        </button>
        <button onClick={() => handleIsolateHost(incident)}>
          ðŸ”’ Isolate Host
        </button>
        <button onClick={() => handleBlockIP(incident)}>
          ðŸš« Block IP
        </button>
      </div>
    </div>
  )
}
```

---

### Step 4: Attack Graph (D3.js) (Hour 16-22)

**components/incident/AttackGraph.jsx:**
```jsx
import { useEffect, useRef } from 'react'
import * as d3 from 'd3'

const SOURCE_COLORS = {
  camera:  '#ef4444',
  logs:    '#3b82f6',
  network: '#22c55e',
  rf:      '#a855f7',
  file:    '#f97316'
}

export default function AttackGraph({ graphData }) {
  // graphData = { nodes: [...], edges: [...] }
  // nodes: { id, source_type, score, label, timestamp }
  // edges: { source, target, confidence, relationship }
  
  const svgRef = useRef()

  useEffect(() => {
    if (!graphData || !svgRef.current) return

    const width = 800, height = 500
    d3.select(svgRef.current).selectAll("*").remove()

    const svg = d3.select(svgRef.current)
      .attr("width", width)
      .attr("height", height)
      .style("background", "#0a0e1a")

    // Force simulation
    const simulation = d3.forceSimulation(graphData.nodes)
      .force("link", d3.forceLink(graphData.edges).id(d => d.id).distance(120))
      .force("charge", d3.forceManyBody().strength(-300))
      .force("center", d3.forceCenter(width / 2, height / 2))

    // Draw edges with arrow markers
    svg.append("defs").append("marker")
      .attr("id", "arrow")
      .attr("viewBox", "0 -5 10 10")
      .attr("refX", 25)
      .attr("markerWidth", 6)
      .attr("markerHeight", 6)
      .attr("orient", "auto")
      .append("path")
      .attr("d", "M0,-5L10,0L0,5")
      .attr("fill", "#475569")

    const edges = svg.append("g").selectAll("line")
      .data(graphData.edges).enter().append("line")
      .attr("stroke", "#475569")
      .attr("stroke-width", d => d.confidence * 3)
      .attr("marker-end", "url(#arrow)")

    // Draw nodes
    const nodes = svg.append("g").selectAll("circle")
      .data(graphData.nodes).enter().append("g")
      .call(d3.drag()
        .on("start", (event, d) => {
          if (!event.active) simulation.alphaTarget(0.3).restart()
          d.fx = d.x; d.fy = d.y
        })
        .on("drag", (event, d) => { d.fx = event.x; d.fy = event.y })
        .on("end", (event, d) => {
          if (!event.active) simulation.alphaTarget(0)
          d.fx = null; d.fy = null
        })
      )

    nodes.append("circle")
      .attr("r", d => 20 + (d.score / 10))
      .attr("fill", d => SOURCE_COLORS[d.source_type])
      .attr("stroke", "#fff")
      .attr("stroke-width", 2)
      .attr("opacity", 0.9)

    // Score label inside circle
    nodes.append("text")
      .text(d => d.score)
      .attr("text-anchor", "middle")
      .attr("dy", "0.35em")
      .attr("fill", "white")
      .attr("font-size", "11px")
      .attr("font-weight", "bold")

    // Source label below circle
    nodes.append("text")
      .text(d => d.label)
      .attr("text-anchor", "middle")
      .attr("dy", "40px")
      .attr("fill", "#94a3b8")
      .attr("font-size", "10px")

    simulation.on("tick", () => {
      edges
        .attr("x1", d => d.source.x).attr("y1", d => d.source.y)
        .attr("x2", d => d.target.x).attr("y2", d => d.target.y)
      nodes.attr("transform", d => `translate(${d.x},${d.y})`)
    })

  }, [graphData])

  return <svg ref={svgRef} style={{ borderRadius: '8px', width: '100%' }} />
}
```

---

### Step 5: SHAP Visualization (Hour 22-26)

**components/incident/XAIPanel.jsx:**
```jsx
import { BarChart, Bar, XAxis, YAxis, Cell, Tooltip, ResponsiveContainer } from 'recharts'

export default function XAIPanel({ explanation }) {
  const { nlg_explanation, shap_by_source } = explanation

  return (
    <div style={{ padding: '20px' }}>
      
      {/* Natural Language Explanation */}
      <div style={{ background: '#1a2233', borderRadius: '8px', padding: '20px', marginBottom: '24px' }}>
        <h3 style={{ color: '#ef4444', marginBottom: '16px' }}>
          Why Risk Score = {explanation.risk_score}?
        </h3>
        {nlg_explanation.sections.map(section => (
          <div key={section.source} style={{
            borderLeft: `3px solid ${SOURCE_COLORS[section.source.toLowerCase()]}`,
            paddingLeft: '16px',
            marginBottom: '16px'
          }}>
            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
              <strong>{section.icon} {section.source}</strong>
              <span style={{ color: getRiskColor(section.score) }}>
                {section.score}/100
              </span>
            </div>
            <p style={{ color: '#94a3b8', fontSize: '14px', marginTop: '4px' }}>
              {section.text}
            </p>
          </div>
        ))}
        <div style={{ borderTop: '1px solid #1e2d45', paddingTop: '16px', marginTop: '8px' }}>
          <p style={{ color: '#60a5fa', fontSize: '14px' }}>
            {nlg_explanation.correlation_statement}
          </p>
          <p style={{ color: '#94a3b8', fontSize: '13px', marginTop: '8px' }}>
            MITRE ATT&CK: {nlg_explanation.mitre_statement}
          </p>
        </div>
      </div>

      {/* SHAP Charts per source */}
      {Object.entries(shap_by_source).map(([source, shapData]) => (
        <div key={source} style={{ marginBottom: '24px' }}>
          <h4 style={{ color: SOURCE_COLORS[source], marginBottom: '12px' }}>
            {SOURCE_ICONS[source]} {source} â€” Feature Importance
          </h4>
          <ResponsiveContainer width="100%" height={200}>
            <BarChart
              data={shapData.features}
              layout="vertical"
              margin={{ left: 120 }}
            >
              <XAxis type="number" stroke="#64748b" />
              <YAxis 
                type="category" 
                dataKey="name" 
                stroke="#94a3b8"
                tick={{ fontSize: 12 }}
              />
              <Tooltip
                contentStyle={{ background: '#1a2233', border: '1px solid #1e2d45' }}
                formatter={(val, name, props) => [
                  `+${val.toFixed(2)} risk contribution`,
                  props.payload.name
                ]}
              />
              <Bar dataKey="shap_value" fill={SOURCE_COLORS[source]} radius={[0,4,4,0]} />
            </BarChart>
          </ResponsiveContainer>
        </div>
      ))}

      {/* Predicted Next Move */}
      <div style={{
        background: '#2d1f00',
        border: '1px solid #92400e',
        borderRadius: '8px',
        padding: '16px'
      }}>
        <h4 style={{ color: '#fbbf24', marginBottom: '8px' }}>
          âš ï¸ Predicted Next Move
        </h4>
        <p style={{ color: '#fde68a', fontSize: '14px' }}>
          {nlg_explanation.prediction_statement}
        </p>
        <div style={{ marginTop: '12px' }}>
          <strong style={{ color: '#e2e8f0', fontSize: '13px' }}>
            Recommended Actions:
          </strong>
          {nlg_explanation.recommended_actions.map((action, i) => (
            <div key={i} style={{ color: '#94a3b8', fontSize: '13px', marginTop: '4px' }}>
              {i + 1}. {action}
            </div>
          ))}
        </div>
      </div>
    </div>
  )
}
```

---

### Step 6: Live Monitoring Charts (Hour 26-32)

**components/live/NetworkChart.jsx:**
```jsx
import { useState, useEffect } from 'react'
import { LineChart, Line, XAxis, YAxis, Tooltip, ReferenceLine, ResponsiveContainer } from 'recharts'
import { useWebSocket } from '../../hooks/useWebSocket'

export default function NetworkChart() {
  const [data, setData] = useState([])
  const BASELINE_MB = 45
  const { messages } = useWebSocket('ws://localhost:8000/ws/live/network')

  useEffect(() => {
    if (messages.length > 0) {
      const latest = messages[0]
      setData(prev => [
        ...prev.slice(-30),  // keep last 30 data points
        {
          time: new Date(latest.timestamp).toLocaleTimeString(),
          volume_mb: latest.bytes_per_minute / 1000000,
          baseline: BASELINE_MB
        }
      ])
    }
  }, [messages])

  return (
    <div style={{ background: '#1a2233', borderRadius: '8px', padding: '16px' }}>
      <h3 style={{ color: '#e2e8f0', marginBottom: '12px' }}>
        ðŸŒ Network Traffic (Live)
      </h3>
      <ResponsiveContainer width="100%" height={200}>
        <LineChart data={data}>
          <XAxis dataKey="time" stroke="#475569" tick={{ fontSize: 10 }} />
          <YAxis stroke="#475569" tick={{ fontSize: 10 }} unit="MB" />
          <Tooltip
            contentStyle={{ background: '#0a0e1a', border: '1px solid #1e2d45' }}
          />
          <ReferenceLine y={BASELINE_MB} stroke="#22c55e" strokeDasharray="4 4" label="Baseline" />
          <Line
            type="monotone"
            dataKey="volume_mb"
            stroke="#3b82f6"
            dot={false}
            strokeWidth={2}
          />
        </LineChart>
      </ResponsiveContainer>
      <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '12px', color: '#64748b' }}>
        <span>Baseline: {BASELINE_MB}MB/min</span>
        <span style={{ color: data[data.length-1]?.volume_mb > BASELINE_MB * 5 ? '#ef4444' : '#22c55e' }}>
          Current: {data[data.length-1]?.volume_mb?.toFixed(1)}MB/min
        </span>
      </div>
    </div>
  )
}
```

---

### Step 7: Sandbox Screenshot Carousel (Hour 32-36)

**components/incident/SandboxReport.jsx:**
```jsx
import { useState } from 'react'

export default function SandboxReport({ sandboxData }) {
  const [currentFrame, setCurrentFrame] = useState(0)
  const [playing, setPlaying] = useState(false)
  const [speed, setSpeed] = useState(500)

  useEffect(() => {
    if (!playing) return
    const interval = setInterval(() => {
      setCurrentFrame(prev => 
        prev < sandboxData.screenshot_sequence.length - 1 ? prev + 1 : 0
      )
    }, speed)
    return () => clearInterval(interval)
  }, [playing, speed])

  return (
    <div style={{ padding: '20px' }}>
      
      {/* Verdict Banner */}
      <div style={{
        background: sandboxData.verdict === 'MALICIOUS' ? '#450a0a' : '#052e16',
        border: `2px solid ${sandboxData.verdict === 'MALICIOUS' ? '#ef4444' : '#22c55e'}`,
        borderRadius: '8px',
        padding: '16px',
        marginBottom: '24px',
        display: 'flex',
        justifyContent: 'space-between',
        alignItems: 'center'
      }}>
        <div>
          <span style={{ fontSize: '24px' }}>
            {sandboxData.verdict === 'MALICIOUS' ? 'ðŸ”´' : 'ðŸŸ¢'}
          </span>
          <strong style={{ fontSize: '20px', marginLeft: '12px' }}>
            {sandboxData.verdict}
          </strong>
          <span style={{ color: '#94a3b8', marginLeft: '12px' }}>
            {sandboxData.confidence_score}% confidence
          </span>
        </div>
        <span style={{ color: '#64748b', fontSize: '13px' }}>
          File: {sandboxData.file_analyzed}
        </span>
      </div>

      {/* Screenshot Player */}
      <div style={{ marginBottom: '24px' }}>
        <h4 style={{ color: '#e2e8f0', marginBottom: '12px' }}>
          ðŸ“¸ Execution Screenshot Sequence ({sandboxData.screenshot_sequence.length} frames)
        </h4>
        
        <div style={{ position: 'relative', background: '#0a0e1a', borderRadius: '8px', overflow: 'hidden' }}>
          <img
            src={`/api/evidence/screenshot/${sandboxData.screenshot_sequence[currentFrame]}`}
            alt={`Frame ${currentFrame}`}
            style={{ width: '100%', display: 'block' }}
          />
          <div style={{
            position: 'absolute',
            top: '8px',
            right: '8px',
            background: 'rgba(0,0,0,0.7)',
            padding: '4px 8px',
            borderRadius: '4px',
            fontSize: '12px'
          }}>
            {currentFrame * 2}s / {sandboxData.detonation_duration_seconds}s
          </div>
        </div>

        {/* Playback Controls */}
        <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginTop: '12px' }}>
          <button onClick={() => setCurrentFrame(0)}>â®</button>
          <button onClick={() => setCurrentFrame(prev => Math.max(0, prev - 1))}>â—€</button>
          <button onClick={() => setPlaying(!playing)}>
            {playing ? 'â¸ Pause' : 'â–¶ Play'}
          </button>
          <button onClick={() => setCurrentFrame(prev => 
            Math.min(sandboxData.screenshot_sequence.length - 1, prev + 1)
          )}>â–¶</button>
          <input
            type="range"
            min={0}
            max={sandboxData.screenshot_sequence.length - 1}
            value={currentFrame}
            onChange={e => setCurrentFrame(Number(e.target.value))}
            style={{ flex: 1 }}
          />
          <select value={speed} onChange={e => setSpeed(Number(e.target.value))}>
            <option value={1000}>0.5x</option>
            <option value={500}>1x</option>
            <option value={250}>2x</option>
            <option value={100}>5x</option>
          </select>
        </div>
      </div>

      {/* Behavioral Summary */}
      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '24px' }}>
        <div style={{ background: '#1a2233', borderRadius: '8px', padding: '16px' }}>
          <h4 style={{ color: '#e2e8f0', marginBottom: '12px' }}>Behavioral Summary</h4>
          {Object.entries(sandboxData.behavioral_summary).map(([key, value]) => (
            <div key={key} style={{ display: 'flex', gap: '8px', marginBottom: '6px', fontSize: '13px' }}>
              <span style={{ color: '#ef4444' }}>âœ—</span>
              <span style={{ color: '#94a3b8' }}>
                {key.replace(/_/g, ' ')}: {Array.isArray(value) ? value.join(', ') : value.toString()}
              </span>
            </div>
          ))}
        </div>

        <div style={{ background: '#1a2233', borderRadius: '8px', padding: '16px' }}>
          <h4 style={{ color: '#e2e8f0', marginBottom: '12px' }}>Extracted IOCs</h4>
          {Object.entries(sandboxData.extracted_iocs).map(([type, values]) => (
            type !== 'mitre_behaviors' && (
              <div key={type} style={{ marginBottom: '10px' }}>
                <span style={{ color: '#64748b', fontSize: '11px', textTransform: 'uppercase' }}>
                  {type}
                </span>
                {(Array.isArray(values) ? values : [values]).map(val => (
                  <div key={val} style={{
                    background: '#0a0e1a',
                    padding: '4px 8px',
                    borderRadius: '4px',
                    fontSize: '12px',
                    fontFamily: 'monospace',
                    color: '#f97316',
                    marginTop: '4px'
                  }}>{val}</div>
                ))}
              </div>
            )
          ))}
          <button style={{ width: '100%', marginTop: '12px' }}>
            Export All IOCs
          </button>
        </div>
      </div>
    </div>
  )
}
```

---

### Implementation Hour Allocation for P1

| Hours | Task | Deliverable |
|-------|------|-------------|
| 0-2 | Docker Compose all services up + FastAPI skeleton | All services running |
| 2-4 | PostgreSQL schemas + WebSocket manager | DB ready + WS infrastructure |
| 4-8 | Kafka consumers (incident + live) | Pipeline consuming events |
| 8-12 | All REST endpoints (incidents, evidence, sandbox, iocs) | Full API surface |
| 12-16 | Blockchain service + MinIO service + Copilot service | All backend services |
| 16-18 | React setup + routing + dark theme + sidebar | Frontend shell |
| 18-24 | Alert Feed page + AlertCard + WebSocket hook | Homepage working live |
| 24-28 | Incident Detail page + Timeline + tabs structure | Incident page shell |
| 28-32 | Attack Graph (D3.js) + Evidence Gallery | Graph + evidence tabs |
| 32-36 | Sandbox Report + screenshot carousel | Sandbox tab complete |
| 36-40 | XAI Panel + SHAP charts + NLG display | XAI tab complete |
| 40-44 | Live Monitoring page + all real-time charts | Live page working |
| 44-48 | SOC Copilot chat UI + Blockchain verification panel | Copilot + chain tabs |
| 48-52 | Threat Intelligence page + MITRE heatmap + IOC feed | Threats page complete |
| 52-56 | UI polish + bug fixes + demo prep + backup video | Final deliverable |